#!/bin/bash
set -e

echo "Stopping containers..."
docker-compose down

read -p "Remove ALL volumes? This will delete ALL persisted data (y/N): " confirm
if [[ "$confirm" =~ ^[Yy]$ ]]; then
    echo "Removing all volumes..."
    docker-compose down --volumes
else
    echo "Skipping volume removal."
fi

echo "Rebuilding images..."
docker-compose build --no-cache

echo "Starting stack..."
docker-compose up -d

